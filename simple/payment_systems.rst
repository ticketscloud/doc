.. _simple/ps:

=================
Платёжные системы
=================

.. _simple/ps/api:

api/BASE
========

:term:`Платёжная система` `api/BASE` используется для проведения заказа по api.
В этом случае деньги за заказ каким-либо образом берёт сам продавец.

* :ref:`Пример работы с заказом без платрона <ex/orders/manual>`

.. _simple/ps/widget:

Оплата через виджет
===================
Для оплаты любого заказа можно открыть виджет сразу на втором шаге со всеми
доступными способами оплаты. Чтобы это сделать необходимо сформировать
URL-виджета обычного виджета, которые доступны в личном кабинете и добавить
GET-параметр `order` с id созданного :ref:`заказа <simple/orders>`.

Структура:
----------
`https://ticketscloud.org/v1/widgets/common?token=r:token&event=:event&order=:order`

:token: можно получить в ЛК в коде вставки любого виджета
:event: id мероприятия
:order: id заказа

.. _simple/ps/invoices:

Выставление счёта
=================

Для того, чтобы сформировать счёт, нужно установить платёжную систему ``system/INVOICE``
и передать необходимые, для выставления счёта, параметры.
Параметры передаются значением ``payment.settings``.

:url: url информации о мероприятии;
:name: наименование платильщика;
:address: юридический адрес;
:orgnip: ОГРНИП (обязательно для ИП);
:orgn: ОГРН (необязательно для ИП);
:inn: ИНН;
:kpp: КПП;
:rs: рассчётный счёт;
:bank: название банка;
:bik: БИК;
:ks: корреспондентский счёт;

После перевода такого заказа в :ref:`in_progress`, покупател будет выслан стандартный
договор-счёт для оплаты.

После получения денег, покупателю автоматически будут высланы билеты и акты об оказании услуг.

.. EXAMPLE
.. Нужен пример создания заказа с выставлением счёта
.. Лучше в два действия: добавляем билеты, а потом, одним запросом, выставляем ПС и переводим в in_progress
