.. _simple/refund:

===============
Возврат билетов
===============

Когда заказ полностью оформлен, билеты можно вернуть в продажу.


.. _simple/refund/create:

Создание запроса на возврат
===========================

Нужно сделать запрос ``POST /v1/resources/refund_requests`` со следующими данными:

:order: id заказа;
:culprit: :ref:`виновник <simple/refund/culprit>` (инициатор) возврата;
:tickets: список id билетов, которые должны остаться в заказе (конфликтует с **tickets_refund**);
:tickets_refund: список id билетов, которые нужно вернуть в заказе (конфликтует с **tickets**);

Будет создан запрос на возврат в статусе ``new``. Для одного заказа может быть создано несколько запросов.

.. _simple/refund/culprit:

Виновник возврата
-----------------

Возврат может быть по различным причинам.
Виновник возврата указывается в поле ``culprit`` при создании запроса на возврат.

:user: виноват в возврате пользователь (например, сдал билет);
:org: виноват организатор (например, отмена мероприятия);
.. :agent: виноват агент;


.. _simple/refund/status:

Подтверждение/отклонение запроса на возврат
===========================================

Запрос ``PATCH /v1/resources/refund_requests/:id``:

:status: ``approved`` или ``rejected``.


Список запросов на возврат
==========================

По запросу ``GET /v1/resources/refund_requests`` возвращается список запросов на возврат билетов.

Фильтры
-------

:status: фильтр по статусу запроса;
:event: запросы по конкретному мероприятию;
:org: запросы по конкретному организатору (актуально для агентов);
:vendor: по конкретному продавцу (для организаторов);

Сортировка
----------

:created_at: по времени создания запроса (по уполчанию);
:value: по стоимости возвращаемых билетов;
